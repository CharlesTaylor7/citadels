{% extends "base.html" %}
{% block config_content %}
  <div class="flex flex-row flex-wrap gap-1">
    {% for (index, option, district) in districts %}
      <label
        class="
          select-none
          cursor-pointer
          p-1 box-content
          rounded-2xl
          [&:has([data-index='1'])]:p-0
          [&:has([data-index='1'])]:border
          [&:has([data-index='1'])]:border-4
          [&:has([data-index='1'])]:border-success
        "
        {% if district.enabled %}
        _="
        on click
          set el to <input /> in me
          get the @data-index of el
          increment it
          set index to it mod 3
          set the @data-index of el to index
          get the @data-vals of el
          call JSON.parse(it)
          set el.value to it[index]
          set form to the closest <form />
          call htmx.ajax('POST', '/lobby/config/districts', { target: '#config', swap: 'outerHTML', source: form})
        end
        "  
        {% endif %}
      >
        <input
          data-index="{{ index }}"
          data-vals="{{ array }}"
          type="hidden"
          name="{{ district.value }}"
          value="{{ option|debug }}"
          class="peer"
        />
        <div 
          class=" relative w-full rounded-t-xl h-10 bg-neutral "
        >
          <div
            class="
              absolute top-2
              leaded
              w-full text-center 
              font-serif
              text-base text-neutral-content
              {% if district.value == "SchoolOfMagic" %}
              ml-2
              {% else if district.value == "ImperialTreasury" %}
              ml-4
              {% else if district.value == "HauntedQuarter" %}
              ml-3
              {% endif %}
            "
          >
            {{ district.name }} 
          </div>
          <code
            class="
              absolute top-2 left-2
              h-6 w-6 rounded-full
              leaded 
              flex flex-row justify-center items-center 
              text-secondary-content 
              {{ district.suit|suit_bg_color }}
            "
          >
          {% match district.cost %}
          {% when Some with (cost) %}
              {{ cost }} 
          {% else %}
          {% endmatch %}
          </code>
          <div
              data-tip="{{ district.description|def }}"
              class="
                bg-gradient-radial
                from-indigo-400
                leaded text-center
                text-sm
                absolute
                top-3
                right-2
                h-4
                w-4
                rounded-full
                bg-base-200
                tooltip
                tooltip-bottom
                tooltip-secondary
                before:max-w-[155px]
                flex flex-col
                justify-center
              "
            >
            i
            </div>

          {% if !district.enabled %}
            <div class="absolute z-10 top-24 w-full text-center text-sm ">
              Coming Soon...
            </div>
          {% endif %}
        </div>
        {% set asset = district.asset %}
        <svg 
          class="rounded-b-xl saturate-100 peer-[[data-index='2']]:saturate-0"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          height="{{ asset.height }}"
          width="{{ asset.width }}"
        >
          <image id="img" x="{{asset.offset_x}}" y="{{asset.offset_y}}"
                height="{{ asset.scale_percentage }}%"
                xlink:href="{{ asset.path }}"
                preserveAspectRatio="xMinYMin slice"
          />
        </svg>
      </label>
    {% endfor %}
  </div>
{% endblock %}
